---
title: "Project1"
author: "Nikhil Singh, Jackie Horn, Xiang Zhao, Xiang Zhao"
date: "October 3, 2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.






# Jackie
```{r}
# Save recs2015_public_v1 from eia website as csv
#incomfrig.data = read.csv("Income data from recs2015.csv", header=TRUE)
#incomfrig.data

#Incomes.1 = filter(incomfrig.data, Incomes==1)

#meanIncomes.1 = mean(Incomes.1$NumFrig)
#meanIncomes.1 
library(tidyverse)
library(ggplot2)
# start of project code 
recs2015 = read.csv("recs2015_public_v1.csv", header=TRUE)
Incomes = recs2015$MONEYPY
NumFrig = recs2015$NUMFRIG
```

```{r}
# make columns of just Incomes and NumFrig then filter the different incomes
# then find the average number of refrigerators each income group has
incomfrig.data = cbind(Incomes,NumFrig)    
incomfrig.data = as.data.frame(incomfrig.data)
Incomes.1 = filter(incomfrig.data, Incomes==1)
meanNumFrig.1 = mean(Incomes.1$NumFrig)          # mean number of friges for income 1 category


Incomes.2 = filter(incomfrig.data, Incomes==2)
meanNumFrig.2 = mean(Incomes.2$NumFrig)


Incomes.3 = filter(incomfrig.data, Incomes==3)
meanNumFrig.3 = mean(Incomes.3$NumFrig)


Incomes.4 = filter(incomfrig.data, Incomes==4)
meanNumFrig.4 = mean(Incomes.4$NumFrig)

Incomes.5 = filter(incomfrig.data, Incomes==5)
meanNumFrig.5 = mean(Incomes.5$NumFrig)


Incomes.6 = filter(incomfrig.data, Incomes==6)
meanNumFrig.6 = mean(Incomes.6$NumFrig)


Incomes.7 = filter(incomfrig.data, Incomes==7)
meanNumFrig.7 = mean(Incomes.6$NumFrig)

Incomes.8 = filter(incomfrig.data, Incomes==8)
meanNumFrig.8 = mean(Incomes.8$NumFrig)

# bar plot #can use a legend to show which 1-8 corresponds to which income
# make data frame of average number of refrigerators and income


Avgs <- c(meanNumFrig.1, meanNumFrig.2, meanNumFrig.3, meanNumFrig.4, meanNumFrig.5, meanNumFrig.6, meanNumFrig.7, meanNumFrig.8)
IncomFrigAvg.data <- data.frame(income = 1:8, average.numfrig = Avgs)
ggplot(data=IncomFrigAvg.data) + geom_col(mapping=aes(x=income, y=average.numfrig), fill = "green")



# now going to look at the relationship between household income and whether or not the household has a refrigerator?




```


After looking at the average number of refrigerators per household in relation to the household's income, as one might anticipate, there does appear to be a slight increase in the number of refrigerators in the households as the income increases. However, the differences are not as big as our team thought. The average number of refrigerators ranges from 1.1 to 1.9. Although the difference in the number of refrigerators in a household based on income is smaller than we expected, we can still utilize this information because those in higher income brackets are still buying relatively more refrigerators, which is relevant to our sales. Perhaps since households with higher incomes tend to have more refrigerators, one of the refrigerators could be quite old and in need of replacement, which is where we come in to make that sale. So now, we want look at other characteristics of refrigerators that may vary more significantly with income, such as the age of the refrigerator. By doing so, we can try to determine what kinds of refrigerators to market to what income demographics in order to enhance the efficiency of our marketing efforts. 

